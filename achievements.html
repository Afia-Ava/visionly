<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Achievements - Visionly</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="achievement-badges.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="dark-mode-global.css">
  <style>
    body {
      background-color: #fff;
      background-image: 
        linear-gradient(135deg, rgba(58,34,89,0.10) 25%, transparent 25%),
        linear-gradient(225deg, rgba(58,34,89,0.10) 25%, transparent 25%),
        linear-gradient(45deg, rgba(58,34,89,0.10) 25%, transparent 25%),
        linear-gradient(315deg, rgba(58,34,89,0.10) 25%, transparent 25%);
      background-size: 20px 20px;
      background-position: 10px 0, 10px 0, 0 0, 0 0;
      color: #333;
      margin: 0;
      padding: 0;
      transition: all 0.3s ease;
    }
    
    /* Remove any custom body::before background for achievements page */
    body::before {
      content: none !important;
      background: none !important;
    }
    
    .achievement-section {
      max-width: 1100px;
      margin: 64px auto 32px; /* Match other pages: less top/bottom margin */
      padding: 0 24px;
    }
    
    .section-title {
      text-align: left;
      margin-bottom: 18px; /* Match other pages */
      font-size: 2rem;
      color: #2d1a45;
      font-weight: 700;
    }
    
    /* Fix badge headings to match other pages */
    .badges-column .left-heading {
      margin: 15px 0 20px; /* Adjusted margin */
      padding-bottom: 8px;
    }
    
    /* Layout modifications for side-by-side design */
    .achievement-content {
      display: flex;
      flex-direction: row;
      gap: 32px;
      margin-top: 40px;
      align-items: flex-start;
    }
    
    /* Left side styling - stats column */
    .stats-column {
      flex: 0 0 320px;
      position: sticky;
      top: 100px;
    }
    
    /* Right side styling - badges column */
    .badges-column {
      flex: 1;
    }
    
    /* Change the streak display to purple */
    .streak-display {
      background: linear-gradient(135deg, #2d1a45 0%, #3a2259 100%); /* Purple gradient */
      border-radius: 18px;
      padding: 35px;
      color: white;
      text-align: center;
      margin-bottom: 30px;
      box-shadow: 0 10px 30px rgba(58,34,89,0.18); /* Purple shadow */
      position: relative;
      overflow: hidden;
      border: 2px solid rgba(255, 255, 255, 0.2);
    }
    
    /* Update the glow effect for the purple box */
    .streak-display::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      background: 
        radial-gradient(circle at 20% 30%, rgba(219, 193, 255, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 80% 70%, rgba(187, 158, 255, 0.3) 0%, transparent 50%);
    }
    
    .streak-title {
      font-size: 1.2rem; /* Smaller title */
      margin-bottom: 12px; /* Less space */
      font-weight: 600;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    }
    
    .streak-days {
      font-size: 3rem; /* Smaller number */
      font-weight: 700;
      margin-bottom: 5px; /* Less space */
      text-shadow: 0 2px 5px rgba(0, 0, 0, 0.25);
      position: relative;
    }
    
    /* Make flame icon smaller */
    .streak-days::after {
      content: '🔥';
      font-size: 1.4rem; /* Smaller flame */
      position: absolute;
      margin-left: 5px;
      bottom: 8px;
      filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.2));
    }
    
    .streak-subtitle {
      font-size: 0.95rem; /* Smaller text */
      opacity: 0.9;
    }
    
    /* Stack stat cards vertically */
    .achievement-stats {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-bottom: 30px;
    }
    
    .stat-card {
      width: 100%;
      margin: 0;
      padding: 18px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      text-align: left;
      background: linear-gradient(145deg, #ede7f6, #e8deff);
      padding: 25px;
      border-radius: 16px;
      width: 180px;
      text-align: center;
      box-shadow: 0 8px 20px rgba(45, 26, 69, 0.15);
      margin: 10px;
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 28px rgba(45, 26, 69, 0.2);
    }
    
    .stat-number {
      font-size: 2.4rem;
      line-height: 1;
      margin-bottom: 0;
      text-align: right;
      color: #2d1a45;
      background: linear-gradient(135deg, #2d1a45, #3a2259);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    
    /* VIBRANT Badge Design - Enhanced Colors */
    .badge-outer {
      width: 110px;
      height: 110px;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 15px;
      cursor: pointer;
      border-radius: 50%;
      background: linear-gradient(135deg, #2d1a45 0%, #3a2259 100%); /* More vibrant purple */
      box-shadow: 0 6px 20px rgba(58,34,89,0.18);
      transition: all 0.3s ease;
      overflow: visible;
    }
    
    /* Vibrant ribbon design */
    .badge-outer::before {
      content: '';
      position: absolute;
      width: 130%;
      height: 130%;
      background: conic-gradient(
        from 0deg, 
        rgba(149, 55, 255, 0) 0deg, 
        rgba(187, 96, 255, 0.2) 70deg,
        rgba(187, 96, 255, 0.5) 90deg,
        rgba(187, 96, 255, 0.2) 110deg,
        rgba(149, 55, 255, 0) 180deg,
        rgba(149, 55, 255, 0) 0deg
      );
      border-radius: 50%;
      z-index: -1;
      animation: rotateSlow 12s linear infinite;
    }
    
    .badge-inner {
      width: 85px;
      height: 85px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(145deg, #2d1a45 0%, #3a2259 100%); /* More vibrant inner gradient */
      border: 3px solid rgba(58,34,89,0.15); /* Brighter border */
      box-shadow: inset 0 2px 12px rgba(0,0,0,0.5), 0 0 15px rgba(149, 55, 255, 0.3);
      position: relative;
      z-index: 1;
      overflow: hidden;
    }
    
    /* Improved pattern overlay with more glow */
    .badge-inner::after {
      content: '';
      position: absolute;
      inset: 0;
      background: 
        radial-gradient(circle at 50% 80%, transparent 20%, rgba(0,0,0,0.25) 100%),
        radial-gradient(circle at 80% 20%, rgba(255,255,255,0.2) 0%, transparent 100%);
      z-index: -1;
    }
    
    /* Enhanced metallic rim effect */
    .badge-rim {
      position: absolute;
      width: 100%;
      height: 100%;
      border: 4px solid #3a2259; /* Brighter border color */
      border-radius: 50%;
      box-sizing: border-box;
      opacity: 0.7;
      background: linear-gradient(145deg, rgba(255,255,255,0.4) 0%, transparent 50%, rgba(0,0,0,0.1) 100%);
    }
    
    .badge-outer:hover {
      transform: scale(1.12) rotate(5deg); /* Bigger scale effect */
      box-shadow: 0 8px 30px rgba(149, 55, 255, 0.6); /* More pronounced glow */
    }
    
    .badge-outer:hover .badge-rim {
      opacity: 1;
      border-color: #F1C6FF; /* Even brighter on hover */
    }
    
    /* Badge icon styling - Brighter colors */
    .badge-icon {
      color: #FFFFFF; /* Pure white for better contrast */
      font-size: 38px; /* Slightly larger */
      text-shadow: 0 2px 8px rgba(0,0,0,0.4);
      position: relative;
      z-index: 2;
      filter: drop-shadow(0 0 5px rgba(255,255,255,0.7)); /* Glow effect */
    }
    
    /* New badge description subheading - Bolder */
    .badge-description {
      text-align: center;
      font-size: 0.85rem; /* Slightly larger */
      color: #2d1a45;
      margin-top: 10px;
      font-weight: 600; /* Bolder text */
      max-width: 120px; /* Slightly wider */
      line-height: 1.3;
      transition: color 0.3s ease;
    }
    
    .badge-wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 10px 15px 25px;
    }
    
    .badge-wrapper:hover .badge-description {
      color: #3a2259; /* More vibrant on hover */
    }
    
    /* Locked badge description style */
    .badge-locked + .badge-description {
      color: #888;
      font-style: italic;
    }
    
    /* Category headings */
    .badge-category-title {
      text-align: center;
      margin: 40px 0 20px;
      color: transparent;
      background: linear-gradient(90deg, #2d1a45 10%, #3a2259 90%);
      -webkit-background-clip: text;
      background-clip: text;
      font-size: 1.5rem;
      font-weight: 700;
      letter-spacing: 0.5px;
      position: relative;
    }
    
    .badge-category-title::after {
      content: '';
      position: absolute;
      left: 50%;
      bottom: -8px;
      width: 80px;
      height: 3px;
      background: linear-gradient(90deg, #2d1a45, #3a2259);
      transform: translateX(-50%);
      border-radius: 3px;
    }
    
    .badge-category-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 40px;
    }
    
    /* Badge shine animation */
    .badge-shine {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 0.4) 50%, /* Brighter shine */
        rgba(255, 255, 255, 0) 100%
      );
      z-index: 3;
      opacity: 0;
      border-radius: 50%;
      transition: opacity 0.3s ease;
    }
    
    .badge-outer:hover .badge-shine {
      opacity: 1;
      animation: badgeShine 1.2s ease-in-out; /* Slightly faster */
    }
    
    /* Badge unlock animation */
    .badge-new {
      animation: unlockPulse 1.5s ease infinite;
    }
    
    .badge-new::after {
      content: '';
      position: absolute;
      inset: -15px;
      border-radius: 50%;
      background: radial-gradient(rgba(149, 55, 255, 0.4) 0%, transparent 70%);
      animation: glowPulse 1.5s ease-in-out infinite alternate;
      z-index: -1;
    }
    
    @keyframes glowPulse {
      0% { opacity: 0.3; transform: scale(0.95); }
      100% { opacity: 0.7; transform: scale(1.05); }
    }
    
    @keyframes unlockPulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.08); }
      100% { transform: scale(1); }
    }
    
    /* Improved stats cards */
    .stat-card {
      background: linear-gradient(145deg, #ede7f6, #e8deff);
      padding: 25px;
      border-radius: 16px;
      width: 180px;
      text-align: center;
      box-shadow: 0 8px 20px rgba(45, 26, 69, 0.15);
      margin: 10px;
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 28px rgba(45, 26, 69, 0.2);
    }
    
    .stat-number {
      font-size: 2.8rem;
      font-weight: 700;
      background: linear-gradient(135deg, #7602FF, #9537FF);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      margin-bottom: 5px;
    }
    
    .stat-label {
      font-size: 1.1rem;
      color: #444;
      font-weight: 500;
    }
    
    /* Make headings more visible with darker colors */
    .left-heading {
      font-size: 1.4rem;
      color: #2d1a45; /* Dark purple color */
      margin: 25px 0 15px;
      font-weight: 700;
      text-shadow: 0 1px 1px rgba(0,0,0,0.05);
    }
    
    /* Darker color for section titles to improve visibility */
    .section-title, 
    .left-heading {
      color: #2d1a45 !important;
    }
    
    /* Add subtle underline to the headings for better visibility */
    .badges-column .left-heading {
      position: relative;
      display: inline-block;
      padding-bottom: 6px;
    }
    
    .badges-column .left-heading::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 40px;
      height: 3px;
      background: linear-gradient(90deg, #2d1a45, #3a2259);
      border-radius: 2px;
    }
  </style>
</head>
<body style="font-family: 'Inter', sans-serif; background-color: #fff; color: #333; margin: 0; padding: 0;">
  <nav class="navbar" style="position: fixed; top: 0; width: 100%; background-color: #fff; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08); padding: 14px 30px; height: 70px; display: flex; align-items: center; justify-content: space-between; z-index: 1000; box-sizing: border-box;">
    <a href="index.html" class="logo" style="font-family: 'Dancing Script', cursive; font-weight: bold; font-size: 2rem; color: #2d1a45; text-decoration: none;">Visionly</a>
    <div style="display: flex; align-items: center;">
      <a href="index.html" style="text-decoration: none; color: #2d1a45; margin: 0 12px;">Home</a>
      <a href="create-board.html" style="text-decoration: none; color: #2d1a45; margin: 0 12px;">Create</a>
      <a href="boards.html" style="text-decoration: none; color: #2d1a45; margin: 0 12px;">Boards</a>
      <a href="progress.html" style="text-decoration: none; color: #2d1a45; margin: 0 12px;">Progress</a>
      <a href="elevate.html" style="text-decoration: none; color: #2d1a45; margin: 0 12px; margin-right: 15px;">Elevate</a>
      <img id="profile-photo" src="https://via.placeholder.com/40x40/ff6b6b/ffffff?text=U" alt="Profile" style="width: 38px; height: 38px; border-radius: 50%; cursor: pointer;">
    </div>
  </nav>

  <div style="max-width: 1100px; margin: 100px auto 40px; padding: 40px 24px 24px 24px; background: #fff; border-radius: 14px; box-shadow: 0 2px 8px rgba(0,0,0,0.07);">
    <header style="margin-bottom: 36px;">
      <h1 style="font-size: 2.2rem; font-weight: 700; color: #2d1a45; margin-bottom: 8px;">Achievements</h1>
      <p style="color: #666; font-size: 1.08rem; margin-bottom: 0;">Celebrate your progress and unlock new milestones</p>
    </header>
    <div style="display: flex; flex-wrap: wrap; gap: 40px;">
      <!-- Stats Column -->
      <div style="flex: 1 1 260px; min-width: 260px; max-width: 320px;">
        <div style="background: linear-gradient(135deg, #2d1a45 0%, #3a2259 100%); border-radius: 18px; padding: 32px 24px; color: white; text-align: center; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(58,34,89,0.18);">
          <h2 style="font-size: 1.1rem; margin-bottom: 10px; font-weight: 600;">Current Streak</h2>
          <div id="streak-days" style="font-size: 2.5rem; font-weight: 700; margin-bottom: 5px;">0 🔥</div>
          <div style="font-size: 1rem; opacity: 0.9;">days in a row</div>
        </div>
        <div style="display: flex; flex-direction: column; gap: 16px;">
          <div style="background: linear-gradient(145deg, #ede7f6, #e8deff); padding: 18px 20px; border-radius: 12px; text-align: center; box-shadow: 0 4px 12px rgba(45, 26, 69, 0.07);">
            <div id="focus-hours" style="font-size: 2rem; font-weight: 700; color: #2d1a45; font-family: 'Inter', sans-serif;">0</div>
            <div style="font-size: 1rem; color: #444; font-family: 'Inter', sans-serif;">Focus Hours</div>
          </div>
          <div style="background: linear-gradient(145deg, #ede7f6, #e8deff); padding: 18px 20px; border-radius: 12px; text-align: center; box-shadow: 0 4px 12px rgba(45, 26, 69, 0.07);">
            <div id="goals-completed" style="font-size: 2rem; font-weight: 700; color: #2d1a45; font-family: 'Inter', sans-serif;">0</div>
            <div style="font-size: 1rem; color: #444; font-family: 'Inter', sans-serif;">Goals Completed</div>
          </div>
          <div style="background: linear-gradient(145deg, #ede7f6, #e8deff); padding: 18px 20px; border-radius: 12px; text-align: center; box-shadow: 0 4px 12px rgba(45, 26, 69, 0.07);">
            <div id="badges-earned" style="font-size: 2rem; font-weight: 700; color: #2d1a45; font-family: 'Inter', sans-serif;">0</div>
            <div style="font-size: 1rem; color: #444; font-family: 'Inter', sans-serif;">Badges Earned</div>
          </div>
          <div style="background: linear-gradient(145deg, #ede7f6, #e8deff); padding: 18px 20px; border-radius: 12px; text-align: center; box-shadow: 0 4px 12px rgba(45, 26, 69, 0.07);">
            <div id="longest-streak" style="font-size: 2rem; font-weight: 700; color: #2d1a45; font-family: 'Inter', sans-serif;">0</div>
            <div style="font-size: 1rem; color: #444; font-family: 'Inter', sans-serif;">Longest Streak</div>
          </div>
        </div>
      </div>
      <!-- Badges Column -->
      <div style="flex: 2 1 400px; min-width: 320px;">
        <h2 style="font-size: 1.3rem; color: #2d1a45; font-weight: 700; margin-bottom: 18px;">Achievement Badges</h2>
        <div style="display: flex; flex-wrap: wrap; gap: 28px;">
          <!-- Example Badge -->
          <div style="display: flex; flex-direction: column; align-items: center; width: 120px;">
            <div style="width: 90px; height: 90px; border-radius: 50%; background: linear-gradient(135deg, #2d1a45 0%, #3a2259 100%); box-shadow: 0 6px 20px rgba(45,26,69,0.22); display: flex; align-items: center; justify-content: center; margin-bottom: 10px; position: relative;">
              <span style="font-size: 2rem; color: #fff; text-shadow: 0 2px 8px rgba(0,0,0,0.18);">⭐</span>
            </div>
            <div style="text-align: center; font-size: 0.95rem; color: #2d1a45; font-weight: 600;">First Vision Board</div>
            <div style="font-size: 0.85rem; color: #888; margin-top: 2px;">Unlocked</div>
          </div>
          <div style="display: flex; flex-direction: column; align-items: center; width: 120px;">
            <div style="width: 90px; height: 90px; border-radius: 50%; background: linear-gradient(135deg, #2d1a45 0%, #3a2259 100%); box-shadow: 0 6px 20px rgba(45,26,69,0.22); display: flex; align-items: center; justify-content: center; margin-bottom: 10px; position: relative;">
              <span style="font-size: 2rem; color: #fff; text-shadow: 0 2px 8px rgba(0,0,0,0.18);">📖</span>
            </div>
            <div style="text-align: center; font-size: 0.95rem; color: #2d1a45; font-weight: 600;">Journal Master</div>
            <div style="font-size: 0.85rem; color: #888; margin-top: 2px;">Locked</div>
          </div>
          <div style="display: flex; flex-direction: column; align-items: center; width: 120px;">
            <div style="width: 90px; height: 90px; border-radius: 50%; background: linear-gradient(135deg, #2d1a45 0%, #3a2259 100%); box-shadow: 0 6px 20px rgba(45,26,69,0.22); display: flex; align-items: center; justify-content: center; margin-bottom: 10px; position: relative;">
              <span style="font-size: 2rem; color: #fff; text-shadow: 0 2px 8px rgba(0,0,0,0.18);">🏆</span>
            </div>
            <div style="text-align: center; font-size: 0.95rem; color: #2d1a45; font-weight: 600;">Goal Crusher</div>
            <div style="font-size: 0.85rem; color: #888; margin-top: 2px;">Locked</div>
          </div>
          <!-- Add more badges as needed -->
        </div>
      </div>
    </div>
  </div>

  <!-- Background Sound -->
  <audio id="background-sound" loop>
      <source src="assets/relaxing-nature-sound.mp3" type="audio/mpeg">
      Your browser does not support the audio element.
  </audio>

  <!-- Toggle Sound Button -->
  <button id="toggle-sound" style="position: fixed; bottom: 20px; right: 20px; width: 50px; height: 50px; border-radius: 50%; background: #2d1a45; border: none; cursor: pointer; box-shadow: 0 4px 12px rgba(45, 26, 69, 0.3); display: flex; align-items: center; justify-content: center; z-index: 1000; transition: transform 0.2s ease;">
      <img src="assets/speaker-on-icon.png" alt="Sound On" id="sound-icon" style="width: 20px; height: 20px; filter: brightness(0) invert(1);">
  </button>
  <script src="firebase-config.js"></script>
  <script src="profile-dropdown.js"></script>
  <script src="shared-scripts.js"></script>
  <script src="dark-mode-toggle.js"></script>
  <script>
    // Immediately apply dark mode class before DOMContentLoaded for no-flash
    (function() {
      if (localStorage.getItem('darkMode') === 'enabled') {
        document.body.classList.add('dark-mode');
      }
    })();

    document.addEventListener('DOMContentLoaded', function() {
      // Fix streak display to ensure it's purple
      document.querySelector('.streak-display').style.background = 'linear-gradient(135deg, #6B46C1 0%, #9537FF 100%)';
      document.querySelector('.streak-display').style.boxShadow = '0 10px 30px rgba(107, 70, 193, 0.25)';
      
      // Force check dark mode from localStorage and apply immediately
      const isDarkMode = localStorage.getItem('darkMode') === 'enabled';
      if (isDarkMode) {
        document.body.classList.add('dark-mode');
        console.log('Dark mode applied on page load');
        
        // Force dark mode styles to take effect
        document.documentElement.style.setProperty('--force-repaint', '1');
        setTimeout(() => {
          document.documentElement.style.removeProperty('--force-repaint');
        }, 10);
      }
      
      // Listen for dark mode changes from other tabs/pages
      window.addEventListener('storage', function(e) {
        if (e.key === 'darkMode') {
          if (e.newValue === 'enabled') {
            document.body.classList.add('dark-mode');
          } else {
            document.body.classList.remove('dark-mode');
          }
        }
      });

      // Optionally, if your dark-mode-toggle.js exposes a function to sync UI, call it here:
      if (window.syncDarkModeUI) {
        window.syncDarkModeUI();
      }

      // Set all stats to 0 initially
      document.getElementById('focus-hours').textContent = '0';
      document.getElementById('goals-completed').textContent = '0';
      document.getElementById('badges-earned').textContent = '0';
      document.getElementById('longest-streak').textContent = '0';
      document.getElementById('streak-days').textContent = '0 🔥';

      // TODO: Fetch and update these stats as user completes more stuff
      // Example:
      // fetchUserStats().then(stats => {
      //   document.getElementById('focus-hours').textContent = stats.focusHours;
      //   document.getElementById('goals-completed').textContent = stats.goalsCompleted;
      //   document.getElementById('badges-earned').textContent = stats.badgesEarned;
      //   document.getElementById('longest-streak').textContent = stats.longestStreak;
      //   document.getElementById('streak-days').textContent = stats.currentStreak + ' 🔥';
      // });
      
      // Fetch actual user data from server/localStorage when available
      function fetchUserStats() {
        // This function would normally fetch data from your backend
        // For demo purposes, we'll just simulate loading some stats after a delay
        setTimeout(() => {
          // Update with real values from the server/localStorage when user is authenticated
          // Only update if user is logged in and has stats
          if (window.isUserLoggedIn) {
            document.getElementById('focus-hours').textContent = '12';
            document.getElementById('goals-completed').textContent = '3';
            document.getElementById('badges-earned').textContent = '4';
            document.getElementById('longest-streak').textContent = '7';
            document.getElementById('streak-days').textContent = '3 🔥';
          }
        }, 1000);
      }
      
      // For demo, unlock some badges
      window.achievementBadges.unlockBadge('streak3');
      window.achievementBadges.unlockBadge('firstGoal');
      window.achievementBadges.unlockBadge('journalEntries');
      window.achievementBadges.unlockBadge('focusHours');
      
      // Render badges
      window.achievementBadges.renderBadges('achievement-badges-container');
      
      // Try to fetch user stats if they exist
      fetchUserStats();
      
      // For demo purposes - show an achievement unlock after 3 seconds
      setTimeout(() => {
        if (!window.achievementBadges.hasBadge('futureMessage')) {
          window.achievementBadges.unlockBadge('futureMessage');
          window.achievementBadges.renderBadges('achievement-badges-container');
        }
      }, 3000);
    });
  </script>

  <!-- Add this before the closing </body> tag -->
  <script src="mouse-sprinkles-script.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Remove any previous sprinkle intervals if present
      if (window._sprinkleInterval) clearInterval(window._sprinkleInterval);
      // Remove any existing sprinkles
      document.querySelectorAll('.sprinkle-particle').forEach(el => el.remove());
      // Sprinkle function
      window.createSprinkle = function(x, y) {
        if (!x || !y) return;
        const colors = ['#8b5fbf', '#6b46c1', '#9d78c9', '#2d1a45', '#3a2259'];
        const color = colors[Math.floor(Math.random() * colors.length)];
        const size = 4 + Math.random() * 4;
        const sprinkle = document.createElement('div');
        sprinkle.className = 'sprinkle-particle';
        sprinkle.style.cssText = `
          position: fixed;
          width: ${size}px;
          height: ${size}px;
          background-color: ${color};
          border-radius: 50%;
          left: ${x}px;
          top: ${y}px;
          pointer-events: none;
          z-index: 9999;
          opacity: 0.8;
          transform: scale(0);
          animation: sprinkleFadeOut 1s ease forwards;
        `;
        document.body.appendChild(sprinkle);
        setTimeout(() => {
          if (sprinkle.parentNode) sprinkle.parentNode.removeChild(sprinkle);
        }, 1000);
      };
      // Sprinkle animation keyframes (if not already present)
      if (!document.getElementById('sprinkle-styles')) {
        const style = document.createElement('style');
        style.id = 'sprinkle-styles';
        style.textContent = `
          @keyframes sprinkleFadeOut {
            0% { transform: scale(0); opacity: 0.8; }
            50% { transform: scale(1); opacity: 0.6; }
            100% { transform: scale(0); opacity: 0; }
          }
        `;
        document.head.appendChild(style);
      }
      // Sprinkle on mousemove
      document.addEventListener('mousemove', function(e) {
        if (Math.random() > 0.6) {
          createSprinkle(e.clientX, e.clientY);
        }
      });
    });
  </script>
  <!-- Place this after the audio/button markup and before any other per-page sound logic -->
  <script src="shared-scripts.js"></script>
  <script>
document.addEventListener('DOMContentLoaded', function() {
    var audio = document.getElementById('background-sound');
    var toggleBtn = document.getElementById('toggle-sound');
    var soundIcon = document.getElementById('sound-icon');
    if (!audio || !toggleBtn || !soundIcon) return;

    audio.volume = 0.5;

    function updateIcon() {
        if (audio.paused) {
            soundIcon.src = 'assets/speaker-off-icon.png';
            soundIcon.alt = 'Sound Off';
        } else {
            soundIcon.src = 'assets/speaker-on-icon.png';
            soundIcon.alt = 'Sound On';
        }
    }

    function tryPlay() {
        audio.play().then(updateIcon).catch(updateIcon);
    }
    tryPlay();

    // Try again on first user interaction (required by most browsers)
    const enableAudio = () => {
        if (audio.paused) tryPlay();
    };
    document.addEventListener('click', enableAudio, { once: true });
    document.addEventListener('touchstart', enableAudio, { once: true });
    document.addEventListener('keydown', enableAudio, { once: true });

    // Toggle sound on button click
    toggleBtn.addEventListener('click', function(e) {
        e.preventDefault();
        if (audio.paused) {
            audio.play().then(updateIcon);
        } else {
            audio.pause();
            updateIcon();
        }
        // Sync state to localStorage for cross-tab sync
        localStorage.setItem('visionly-bg-music', JSON.stringify({
            time: audio.currentTime,
            paused: audio.paused,
            ts: Date.now()
        }));
    });

    audio.addEventListener('play', updateIcon);
    audio.addEventListener('pause', updateIcon);

    updateIcon();
});
  </script>
  <script>
document.addEventListener('DOMContentLoaded', function() {
    const navPhoto = document.getElementById('profile-photo');
    const uploaded = localStorage.getItem('profileAvatarUpload');
    if (navPhoto && uploaded) {
        navPhoto.src = uploaded;
    }
});
  </script>
</body>
</html>
